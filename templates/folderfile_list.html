<div id="ajax_filelistresult">

    <div class="object-detail--right">

        {% if files %}
            Файлы:
        {% endif %}

        <div class="table-files">
            {% for file in files %}
                <div class="row-files">
                    {% if current_user == file.author %}
                        <div class="cell-files"><span class="hint hint--bottom hint--info" data-hint="Удалить этот файл"><input type="checkbox" value="{{file.id}}" name="myCheck_{{file.id}}" /></span></div>
                    {% endif %}
                    <div class="cell-files"><a href="{{ media_path }}{{ file.pfile }}" target="_blank">{{ file.uname }}</a></div>
                    <div class="cell-files"><em style="font-size:80%">{{ file.psize|filesizeformat }}</em></div>
                    <div class="cell-files"><em style="font-size:80%">{{ file.datecreate|date:'d.m.y' }} {{ file.datecreate|time:'H:i:s' }}</em></div>
                </div>
            {% endfor %}
        </div>
        <br />

    </div>

</div>

<div id="ajax_filelisterrors"></div>

<script>

    $('input[type="checkbox"]').change(function() {
        //console.log({{ companyid }})
        //console.log({{ companyuser.id }})
        // Проверка, стоит галочка или нет
        if ($(this).is(':checked')) {

            var chk = $(this).attr("name");
            var chkVal = $(this).attr("value");
            //console.log(chkVal)

            $.ajax({
                url: "{% url 'my_main:objectfile_delete' objtype %}",
                type: 'GET',
                data: { fileid: chkVal,
                    //companyid: "8",
                    //pk: {{ companyuser.id }},
                },
                success: function(data) {
                    $('#ajax_filelistresult').html(data);
                },
                error: function(xhr, errmsg, err) {
                    console.log("error")
                    $('#ajax_filelisterrors').html('Файл не найден!');
                }

            });

        };

    });

</script>